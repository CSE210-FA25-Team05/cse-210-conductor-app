<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: backend/src/services/course/course.repo.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: backend/src/services/course/course.repo.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

/**
 * Course Repository
 *
 * This module provides data access methods for course-related operations.
 */

/**
 * Get all courses.
 * @param {FastifyInstance} fastify - Fastify instance with Prisma client
 * @returns {Promise&lt;Array>} List of all courses
 */
async function getAllCourse(fastify) {
    const courses = await fastify.db.courses.findMany();
    return courses;
}

/**
 * Get a course by ID.
 * @param {FastifyInstance} fastify - Fastify instance with Prisma client
 * @returns {Promise&lt;Object>} Course object
 */
async function getCourseById(fastify, courseId) {
        const course = await fastify.db.courses.findUnique({
            where: { id: courseId },
        });
        return course;
}

/**
 * Get users in a course.
 * @param {FastifyInstance} fastify - Fastify instance with Prisma client
 * @returns {Promise&lt;Array>} List of users in the course
 */
async function getUsersInCourse(fastify, courseId) {
        const users = await fastify.db.enrollments.findMany({
            where: { courses: { some: { id: courseId } } },
        });
        return users;
}

/**
 * Get user details in a course.
 * @param {FastifyInstance} fastify - Fastify instance with Prisma client
 * @returns {Promise&lt;Object>} User object
 */
async function getUserDetailsInCourse(fastify, courseId, userId) {
        const user = await fastify.db.enrollments.findFirst({
            where: {
                id: userId,
                courses: { some: { id: courseId } },
            },
        });
        return user;
}

async function addCourse(fastify, courseData) {
    const {
        course_code,
        course_name,
        term,
        section = null,
        start_date = null,
        end_date = null,
    } = courseData || {}
    if (!course_code || !course_name || !term) {
        const e = new Error('course_code, course_name, term are required')
        e.code = 'BAD_REQUEST'
        throw e
    }
    const created = await fastify.db.courses.create({
        data: {
            course_code,
            course_name,
            term,
            section,
            start_date: start_date ? new Date(start_date) : null,
            end_date:   end_date   ? new Date(end_date)   : null,
        },
    })
    return created
}

async function updateCourse(fastify, courseId, updateData) {
    const updatedCourse = await fastify.db.courses.update({
        where: { id: courseId },
        data: updateData,
    });
    return updatedCourse;
}

async function deleteCourse(fastify, courseId) {
    const deletedCourse = await fastify.db.courses.delete({
        where: { id: courseId },
    });
    return deletedCourse;
}

module.exports = {getAllCourse, getCourseById, getUsersInCourse, getUserDetailsInCourse, addCourse, updateCourse, deleteCourse};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="DirEntry.html">DirEntry</a></li><li><a href="FSWatcher.html">FSWatcher</a></li></ul><h3>Mixins</h3><ul><li><a href="FsEventsHandler.html">FsEventsHandler</a></li><li><a href="NodeFsHandler.html">NodeFsHandler</a></li></ul><h3>Global</h3><ul><li><a href="global.html#DOT_LITERAL">DOT_LITERAL</a></li><li><a href="global.html#FSEventsWatchers">FSEventsWatchers</a></li><li><a href="global.html#FsWatchInstances">FsWatchInstances</a></li><li><a href="global.html#POSIX_REGEX_SOURCE">POSIX_REGEX_SOURCE</a></li><li><a href="global.html#WINDOWS_CHARS">WINDOWS_CHARS</a></li><li><a href="global.html#add">add</a></li><li><a href="global.html#anymatch">anymatch</a></li><li><a href="global.html#authRoutes">authRoutes</a></li><li><a href="global.html#authService">authService</a></li><li><a href="global.html#braces">braces</a></li><li><a href="global.html#buildGoogleLoginUrl">buildGoogleLoginUrl</a></li><li><a href="global.html#colors">colors</a></li><li><a href="global.html#colour">colour</a></li><li><a href="global.html#command">command</a></li><li><a href="global.html#config">config</a></li><li><a href="global.html#createFSEventsInstance">createFSEventsInstance</a></li><li><a href="global.html#createFsWatchInstance">createFsWatchInstance</a></li><li><a href="global.html#createPattern">createPattern</a></li><li><a href="global.html#createSession">createSession</a></li><li><a href="global.html#createSessionForUser">createSessionForUser</a></li><li><a href="global.html#debug">debug</a></li><li><a href="global.html#deleteSession">deleteSession</a></li><li><a href="global.html#encloseBrace">encloseBrace</a></li><li><a href="global.html#enforceEmailRules">enforceEmailRules</a></li><li><a href="global.html#escapeNode">escapeNode</a></li><li><a href="global.html#exceedsLimit">exceedsLimit</a></li><li><a href="global.html#exchangeCodeForTokens">exchangeCodeForTokens</a></li><li><a href="global.html#exec">exec</a></li><li><a href="global.html#execFromPackage">execFromPackage</a></li><li><a href="global.html#expandRange">expandRange</a></li><li><a href="global.html#find">find</a></li><li><a href="global.html#flatten">flatten</a></li><li><a href="global.html#fmtLong">fmtLong</a></li><li><a href="global.html#fmtShort">fmtShort</a></li><li><a href="global.html#formatArgs">formatArgs</a></li><li><a href="global.html#fp">fp</a></li><li><a href="global.html#fsWatchBroadcast">fsWatchBroadcast</a></li><li><a href="global.html#getAllCourse">getAllCourse</a></li><li><a href="global.html#getCourseById">getCourseById</a></li><li><a href="global.html#getUserBySessionId">getUserBySessionId</a></li><li><a href="global.html#getUserDetailsInCourse">getUserDetailsInCourse</a></li><li><a href="global.html#getUsersInCourse">getUsersInCourse</a></li><li><a href="global.html#handleCodeExchangeFromBody">handleCodeExchangeFromBody</a></li><li><a href="global.html#handleGoogleCallback">handleGoogleCallback</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#inspectOpts">inspectOpts</a></li><li><a href="global.html#isInvalidBrace">isInvalidBrace</a></li><li><a href="global.html#isOpenOrClose">isOpenOrClose</a></li><li><a href="global.html#load">load</a></li><li><a href="global.html#loadFile">loadFile</a></li><li><a href="global.html#localstorage">localstorage</a></li><li><a href="global.html#log">log</a></li><li><a href="global.html#matchPatterns">matchPatterns</a></li><li><a href="global.html#merge">merge</a></li><li><a href="global.html#nodemon">nodemon</a></li><li><a href="global.html#nodemonOption">nodemonOption</a></li><li><a href="global.html#parse">parse</a></li><li><a href="global.html#parseDelay">parseDelay</a></li><li><a href="global.html#picomatch">picomatch</a></li><li><a href="global.html#plural">plural</a></li><li><a href="global.html#rangeToPattern">rangeToPattern</a></li><li><a href="global.html#readdirp">readdirp</a></li><li><a href="global.html#reduce">reduce</a></li><li><a href="global.html#s">s</a></li><li><a href="global.html#save">save</a></li><li><a href="global.html#scan">scan</a></li><li><a href="global.html#setFSEventsListener">setFSEventsListener</a></li><li><a href="global.html#setFsWatchFileListener">setFsWatchFileListener</a></li><li><a href="global.html#setFsWatchListener">setFsWatchListener</a></li><li><a href="global.html#setup">setup</a></li><li><a href="global.html#stringToArgs">stringToArgs</a></li><li><a href="global.html#syntaxError">syntaxError</a></li><li><a href="global.html#tty">tty</a></li><li><a href="global.html#upsertUserFromGooglePayload">upsertUserFromGooglePayload</a></li><li><a href="global.html#useColors">useColors</a></li><li><a href="global.html#users">users</a></li><li><a href="global.html#verifyIdToken">verifyIdToken</a></li><li><a href="global.html#watch">watch</a></li><li><a href="global.html#zip">zip</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Sun Nov 16 2025 16:54:18 GMT-0800 (Pacific Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
